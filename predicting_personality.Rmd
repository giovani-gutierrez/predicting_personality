---
title: "Posture Project"
author: "Giovani Gutierrez"
date: "2023-02-15"
output: 
  github_document:
    toc: true
    df_print: "kable"
    keep_html: true

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      warning = FALSE, 
                      message = FALSE,
                      tidy = TRUE,
                      fig.align = 'center')

indent1 = '    '
indent2 = paste(rep(indent1, 2), collapse='')
indent3 = paste(rep(indent1, 3), collapse='')
```

# Getting Started

## Setup
```{r libraries}
library(tidyverse)
library(tidymodels)
library(readxl)
library(janitor)
library(visdat)
library(naniar)
library(corrplot)
tidymodels_prefer()

set.seed(123) # set seed
```

## Import Data
```{r read-in data}
data1 <- 
  read_xls('C:/Users/giova/Desktop/PSTAT 131/predicting_personality/Data/Posture_Data.xls') %>% 
  clean_names() # read in raw data from .xls file

data1 %>% 
  write.csv(file = 'C:/Users/giova/Desktop/PSTAT 131/predicting_personality/Data/raw_data.csv') # write raw data to .csv file

head(data1) # preview data
```

## Tidy Data & Missing Values
```{r missing values, fig.width = 10}
data1 <- 
  data1 %>% 
  replace_with_na_all(condition = ~.x == 'X') # replace 'X' character values with NA values

data1 %>% 
  vis_miss() # visualize missing values

data1 <- 
  data1 %>% 
  select(age:posture & -mbti) %>% 
  drop_na() # drop missing and irrelevant variables

data1 <- 
  data1 %>% 
  mutate(sex = factor(sex)) %>% 
  mutate(activity_level = ordered(activity_level,
                                  levels = c('Low', 'Moderate', 'High'))) %>% 
  mutate_at(c('pain_1', 'pain_2', 'pain_3', 'pain_4'), 
            as.numeric) %>% 
  mutate(e_i = factor(ifelse(e > i, 'extrovert', 'introvert'))) %>% 
  mutate_at(c('s', 'n', 't', 'f', 'j', 'p'), as.numeric) %>% 
  mutate(posture = factor(posture)) %>% 
  select(-e & -i) # coerce variables into appropriate type

data1 %>% 
  vis_dat() # visualize variable types

data1 %>% 
  write.csv(file = 'C:/Users/giova/Desktop/PSTAT 131/predicting_personality/Data/clean_data.csv') # write clean data to .csv file

head(data1) # preview cleaned data
```

* `age`: Age of participant (in years)
* `height`: Height of participant (in inches)
* `weight`: Weight of participant (in pounds)
* `sex`: Sex of the participant (male or female)
* `activity_level`: Amount of daily physical activity performed by a participant (low, moderate, or high)
* `pain_1`: Pain in the neck reported on a scale from 0 (low) to 10 (high) by a participant
* `pain_2`: Pain in the thoracic reported on a scale from 0 (low) to 10 (high) by a participant
* `pain_3`: Pain in the lumbar reported on a scale from 0 (low) to 10 (high) by the participant
* `pain_4`: Pain in the sacrum reported on a scale from 0 (low) to 10 (high) by the participant
* `s`: A participant's sensing characteristic on a scale from 1 (low) to 26 (high)
* `i`: A participant's intuition characteristic on a scale from 1 (low) to 26 (high)
* `t`: A participant's thinking characteristic on a scale from 1 (low) to 26 (high)
* `f`: A participant's feeling characteristic on a scale from 1 (low) to 26 (high)
* `j`: A participant's judging characteristic on a scale from 1 (low) to 26 (high)
* `p`: A participant's perceiving characteristic on a scale from 1 (low) to 26 (high)
* `posture`: Type of posture exhibited by a participant (ideal posture (A), kyphosis-lordosis (B), flat-back (C), and sway-back (D))
* `e_i`: Categorization of participant as an extrovert or introvert; based on whichever score was higher on their MBTI questionnaire


# Exploratory Data Analysis (EDA)

## Correlation Between Features

```{r correlation plot}
data1 %>% 
  select_if(is.numeric) %>% 
  cor() %>% 
  corrplot(method = 'circle', 
           type = 'lower')
```

## Visual EDA
```{r visual eda}
ggplot(data = data1, aes(fill = e_i, x = e_i)) + 
  geom_bar()

ggplot(data = data1, aes(fill = sex, x = e_i)) + 
  geom_bar(position = "fill")

ggplot(data = data1, aes(fill = posture, x = e_i)) + 
  geom_bar(position = "fill")
```

